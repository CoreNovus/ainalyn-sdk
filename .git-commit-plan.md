# Git Commit Plan for Ainalyn SDK

## Commit Strategy for AI-Assisted Development

This document outlines the commit structure for the Ainalyn SDK project.
Each commit represents a significant architectural milestone, making it easy
for future developers to understand the project evolution.

---

## âœ… Completed Work (Retroactive Documentation)

### Phase 1: Project Foundation

```
feat: initialize ainalyn-sdk project structure

- Set up hexagonal architecture directory layout
- Configure pyproject.toml with strict type checking
- Add mypy, ruff, pytest configurations
- Establish development tooling (pre-commit hooks)

Refs: Project initialization
```

---

### Phase 2: ISSUE-01 - Hexagonal Architecture & Domain Layer

```
feat(domain): implement core domain entities

- Add immutable AgentDefinition (Aggregate Root)
- Add Workflow, Node, Module, Prompt, Tool entities
- Add NodeType enum
- All entities are frozen dataclasses with full type hints
- Passes mypy --strict without errors

Implements: ISSUE-01 - Domain Entities
Architecture: Hexagonal (Domain Layer)
SOLID: Single Responsibility, Dependency Inversion
```

```
feat(domain): add domain validation rules

- Implement DefinitionRules for domain-level validation
- Add name pattern validation (lowercase, hyphen-separated)
- Add semantic version validation
- Add workflow validation (entry node, node references)
- Add circular dependency detection (DFS algorithm)
- Add unreachable node detection (BFS algorithm)
- Add unused resource detection

Implements: ISSUE-01 - Domain Rules
Architecture: Hexagonal (Domain Layer)
```

```
feat(ports): define inbound and outbound port interfaces

- Add IDefinitionBuilder (inbound port)
- Add IDefinitionValidator (inbound port)
- Add IDefinitionExporter (inbound port)
- Add ISchemaValidator (outbound port)
- Add IDefinitionWriter (outbound port)
- Add ValidationResult, ValidationError, Severity models
- All ports use Protocol (structural typing)

Implements: ISSUE-01 - Ports
Architecture: Hexagonal (Ports & Adapters)
SOLID: Interface Segregation, Dependency Inversion
```

```
test(domain): add comprehensive domain layer tests

- Add entity immutability tests
- Add domain rules validation tests
- Add circular dependency detection tests
- Add unreachable node detection tests
- Coverage: >90% for domain layer

Implements: ISSUE-01 - Testing
```

---

### Phase 3: ISSUE-02 - DSL Builder API

```
feat(adapters): implement builder error hierarchy

- Add BuilderError base exception
- Add MissingRequiredFieldError
- Add InvalidValueError
- Add InvalidReferenceError
- Add DuplicateNameError
- Add EmptyCollectionError
- All errors provide clear, actionable messages

Implements: ISSUE-02 - Error Handling
Architecture: Primary Adapter
```

```
feat(adapters): implement fluent builder API

- Add ModuleBuilder with schema support
- Add PromptBuilder with variable interpolation
- Add ToolBuilder with schema support
- Add NodeBuilder with resource type selection
- Add WorkflowBuilder with node management
- Add AgentBuilder with resource management and validation
- All builders use fluent interface pattern
- Built-in validation using DefinitionRules

Implements: ISSUE-02 - Fluent Builders
Architecture: Primary Adapter (Inbound)
SOLID: Builder Pattern, Single Responsibility
```

```
feat(api): expose builders in public API

- Export all builders in ainalyn.__init__
- Export builder errors for exception handling
- Update primary adapter __init__.py
- Maintain clean public API surface

Implements: ISSUE-02 - Public API
```

```
test(adapters): add builder unit tests

- Add error hierarchy tests
- Add builder validation tests (names, versions, references)
- Add builder fluent interface tests
- Add duplicate detection tests
- Add missing field detection tests
- Coverage: >85% for adapters

Implements: ISSUE-02 - Testing
```

```
refactor(tests): reorganize test structure to mirror codebase

- Create tests/unit/ and tests/integration/ structure
- Move domain tests to tests/unit/domain/
- Move adapter tests to tests/unit/adapters/
- Add tests/README.md with testing guidelines
- Update pytest configuration
- Maintain 1:1 mapping with source code structure

Improves: Test maintainability and discoverability
```

---

## ðŸ”„ Planned Work (ISSUE-03)

### Phase 4: ISSUE-03 - Validation & Static Analysis

```
feat(adapters): implement schema validator

- Add SchemaValidator implementing ISchemaValidator
- Validate required fields (name, version, description)
- Validate naming conventions using DefinitionRules
- Validate semantic versioning format
- Validate workflow structure (nodes, entry_node)
- Validate node structure (type, reference)
- Generate ValidationError with JSONPath-style locations
- Return list of validation errors

Implements: ISSUE-03 - Schema Validation
Architecture: Secondary Adapter (Outbound)
SOLID: Single Responsibility, Dependency Inversion
```

```
feat(adapters): implement static analyzer

- Add StaticAnalyzer for logical consistency checks
- Detect circular dependencies in workflows (DFS)
- Detect unreachable nodes (BFS from entry_node)
- Detect undefined resource references
- Detect unused modules, prompts, tools
- Generate warnings for potential dead-end nodes
- Use DefinitionRules for analysis logic

Implements: ISSUE-03 - Static Analysis
Architecture: Secondary Adapter
SOLID: Single Responsibility, Open/Closed
```

```
test(adapters): add validation and analysis tests

- Add SchemaValidator unit tests
- Add StaticAnalyzer unit tests
- Test circular dependency detection
- Test unreachable node detection
- Test unused resource detection
- Test error message clarity and JSONPath locations
- Coverage: >85% for validators

Implements: ISSUE-03 - Testing
```

```
feat(api): expose validation in public API

- Export SchemaValidator
- Export StaticAnalyzer
- Update secondary adapter __init__.py
- Add convenience functions for validation

Implements: ISSUE-03 - Public API
```

```
docs: update README with validation examples

- Add validation usage examples
- Document error codes and meanings
- Add static analysis examples
- Update API documentation

Implements: ISSUE-03 - Documentation
```

---

## ðŸ”® Future Work (ISSUE-04, ISSUE-05)

### Phase 5: ISSUE-04 - YAML Export & Application Layer

```
feat(adapters): implement YAML exporter

[To be planned]
```

```
feat(application): implement use cases

[To be planned]
```

### Phase 6: ISSUE-05 - Public API & PyPI Release

```
feat(api): finalize public API surface

[To be planned]
```

```
chore: prepare for PyPI release

[To be planned]
```

---

## Commit Message Format

### Template
```
<type>(<scope>): <subject>

<body>

<footer>
```

### Types
- `feat`: New feature
- `fix`: Bug fix
- `refactor`: Code restructuring
- `test`: Adding or updating tests
- `docs`: Documentation changes
- `chore`: Maintenance tasks
- `perf`: Performance improvements

### Scopes
- `domain`: Domain layer (entities, rules)
- `ports`: Port interfaces
- `adapters`: Adapter implementations
- `application`: Application layer (use cases)
- `api`: Public API surface
- `tests`: Test infrastructure

### Example
```
feat(adapters): implement schema validator

- Add SchemaValidator implementing ISchemaValidator
- Validate required fields and naming conventions
- Generate clear error messages with JSONPath locations

Implements: ISSUE-03
Architecture: Secondary Adapter
SOLID: Single Responsibility, Dependency Inversion
```

---

## Notes for AI-Assisted Development

1. **Granularity**: Each commit represents a complete, testable feature
2. **Context**: Include architectural pattern and SOLID principles
3. **Traceability**: Reference issue numbers
4. **Clarity**: Focus on WHAT and WHY, not HOW (code explains HOW)
5. **Atomic**: Each commit should pass all tests

## Benefits

âœ… **Clear History**: Easy to understand project evolution
âœ… **Reviewable**: Each commit is a logical unit
âœ… **Revertible**: Can safely revert individual features
âœ… **Documentable**: Commit history tells the architecture story
âœ… **AI-Friendly**: Clear context for future AI-assisted development
