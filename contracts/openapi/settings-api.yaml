openapi: 3.0.3
info:
  title: Settings API
  description: |
    Settings Management API - Configure application and user preferences.

    ## Features
    - Application settings management
    - User preference settings
    - Theme and appearance customization
    - API provider configuration
    - Privacy and security settings
    - Notification settings
    - Audio and video settings
    - Performance optimization
    - Settings export/import
    - Cloud sync

    ## Setting Categories
    - theme: Appearance settings
    - language: Language settings
    - api: API configuration
    - privacy: Privacy settings
    - notifications: Notification settings
    - audio: Audio settings
    - video: Video settings
    - performance: Performance settings
  version: 1.0.0
  contact:
    name: API Support
    email: api-support@example.com

servers:
  - url: http://localhost:8000
    description: Development server
  - url: https://api.example.com
    description: Production server

tags:
  - name: settings
    description: Settings management
  - name: theme
    description: Theme settings
  - name: api-configuration
    description: API configuration
  - name: sync
    description: Sync management

paths:
  /api/v1/settings:
    get:
      tags:
        - settings
      summary: Get all settings
      description: Retrieve all application and user settings
      operationId: getSettings
      responses:
        '200':
          description: Settings retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/GetSettingsResponse'
                  metadata:
                    $ref: '#/components/schemas/Metadata'

    put:
      tags:
        - settings
      summary: Update settings
      description: Update application or user settings
      operationId: updateSettings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateSettingsRequest'
      responses:
        '200':
          description: Settings updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/GetSettingsResponse'
                  metadata:
                    $ref: '#/components/schemas/Metadata'
        '400':
          $ref: '#/components/responses/BadRequest'

  /api/v1/settings/app:
    get:
      tags:
        - settings
      summary: Get application settings
      operationId: getAppSettings
      responses:
        '200':
          description: Settings retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/AppSettings'

    put:
      tags:
        - settings
      summary: Update application settings
      operationId: updateAppSettings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AppSettings'
      responses:
        '200':
          description: Settings updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/AppSettings'

  /api/v1/settings/user:
    get:
      tags:
        - settings
      summary: Get user settings
      operationId: getUserSettings
      responses:
        '200':
          description: Settings retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/UserSettings'

    put:
      tags:
        - settings
      summary: Update user settings
      operationId: updateUserSettings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserSettings'
      responses:
        '200':
          description: Settings updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/UserSettings'

  /api/v1/settings/theme:
    get:
      tags:
        - theme
      summary: Get theme settings
      operationId: getThemeSettings
      responses:
        '200':
          description: Settings retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/ThemeSettings'

    put:
      tags:
        - theme
      summary: Update theme settings
      operationId: updateThemeSettings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ThemeSettings'
      responses:
        '200':
          description: Settings updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/ThemeSettings'

  /api/v1/settings/api:
    get:
      tags:
        - api-configuration
      summary: Get API settings
      operationId: getApiSettings
      responses:
        '200':
          description: Settings retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/ApiSettings'

    put:
      tags:
        - api-configuration
      summary: Update API settings
      operationId: updateApiSettings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApiSettings'
      responses:
        '200':
          description: Settings updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/ApiSettings'

  /api/v1/settings/api/providers:
    get:
      tags:
        - api-configuration
      summary: Get all provider settings
      operationId: getProviders
      responses:
        '200':
          description: Providers retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    additionalProperties:
                      $ref: '#/components/schemas/ProviderSettings'

  /api/v1/settings/api/providers/{providerId}:
    put:
      tags:
        - api-configuration
      summary: Update specific provider settings
      operationId: updateProvider
      parameters:
        - name: providerId
          in: path
          required: true
          schema:
            type: string
          description: Provider ID (e.g., openai, anthropic)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProviderSettings'
      responses:
        '200':
          description: Provider updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/ProviderSettings'

  /api/v1/settings/reset:
    post:
      tags:
        - settings
      summary: Reset settings
      description: |
        Reset settings to default values.

        Supported scopes:
        - all: Reset all settings
        - app: Reset application settings only
        - user: Reset user settings only
        - Specific setting keys
      operationId: resetSettings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ResetSettingsRequest'
      responses:
        '200':
          description: Settings reset
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/GetSettingsResponse'

  /api/v1/settings/export:
    post:
      tags:
        - settings
      summary: Export settings
      description: |
        Export settings to a file.

        Supported formats:
        - json: JSON format
        - yaml: YAML format
        - ini: INI format
      operationId: exportSettings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExportSettingsRequest'
      responses:
        '200':
          description: Export successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      downloadUrl:
                        type: string
                        format: uri
                      fileName:
                        type: string
                      fileSize:
                        type: integer

  /api/v1/settings/import:
    post:
      tags:
        - settings
      summary: Import settings
      description: Import settings from a file
      operationId: importSettings
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
                - format
              properties:
                file:
                  type: string
                  format: binary
                  description: Settings file
                format:
                  type: string
                  enum:
                    - json
                    - yaml
                    - ini
                overwrite:
                  type: boolean
                  default: false
                  description: Overwrite existing settings
                validate:
                  type: boolean
                  default: true
                  description: Validate settings before import
      responses:
        '200':
          description: Import successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/GetSettingsResponse'

  /api/v1/settings/validate:
    post:
      tags:
        - settings
      summary: Validate settings
      description: Check if settings are valid
      operationId: validateSettings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AppSettings'
      responses:
        '200':
          description: Validation completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/ValidateSettingsResponse'

  /api/v1/settings/sync:
    post:
      tags:
        - sync
      summary: Sync settings
      description: Sync settings with cloud storage
      operationId: syncSettings
      responses:
        '200':
          description: Sync successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/SyncStatus'

  /api/v1/settings/sync/status:
    get:
      tags:
        - sync
      summary: Get sync status
      operationId: getSyncStatus
      responses:
        '200':
          description: Status retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/SyncStatus'

  /api/v1/settings/defaults:
    get:
      tags:
        - settings
      summary: Get default settings
      description: Get default values for all settings
      operationId: getDefaultSettings
      responses:
        '200':
          description: Defaults retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/AppSettings'

components:
  schemas:
    AppSettings:
      type: object
      required:
        - version
        - theme
        - language
        - api
        - privacy
        - notifications
        - shortcuts
        - audio
        - video
        - performance
        - lastUpdated
      properties:
        version:
          type: string
          description: Settings version
        theme:
          $ref: '#/components/schemas/ThemeSettings'
        language:
          $ref: '#/components/schemas/LanguageSettings'
        api:
          $ref: '#/components/schemas/ApiSettings'
        privacy:
          $ref: '#/components/schemas/PrivacySettings'
        notifications:
          $ref: '#/components/schemas/NotificationSettings'
        shortcuts:
          $ref: '#/components/schemas/ShortcutSettings'
        audio:
          $ref: '#/components/schemas/AudioSettings'
        video:
          $ref: '#/components/schemas/VideoSettings'
        performance:
          $ref: '#/components/schemas/PerformanceSettings'
        experimental:
          $ref: '#/components/schemas/ExperimentalSettings'
        lastUpdated:
          type: string
          format: date-time
        syncEnabled:
          type: boolean
        deviceId:
          type: string

    ThemeSettings:
      type: object
      properties:
        mode:
          type: string
          enum:
            - light
            - dark
            - system
          default: system
        primaryColor:
          type: string
          description: Primary color (HEX)
        secondaryColor:
          type: string
          description: Secondary color (HEX)
        fontSize:
          type: string
          enum:
            - small
            - medium
            - large
          default: medium
        fontFamily:
          type: string
        borderRadius:
          type: integer
        animations:
          type: boolean
          default: true
        reducedMotion:
          type: boolean
          default: false

    LanguageSettings:
      type: object
      properties:
        appLanguage:
          type: string
          description: Application language (e.g., zh-TW, en)
        contentLanguage:
          type: string
          description: Content language
        autoDetect:
          type: boolean
          default: true
        fallbackLanguage:
          type: string
          default: en
        dateFormat:
          type: string
        timeFormat:
          type: string
          enum:
            - 12h
            - 24h
          default: 24h
        numberFormat:
          type: string
        currency:
          type: string

    ApiSettings:
      type: object
      properties:
        defaultProvider:
          type: string
          description: Default API provider
        providers:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/ProviderSettings'
        rateLimit:
          type: object
          properties:
            enabled:
              type: boolean
            requestsPerMinute:
              type: integer
            tokensPerMinute:
              type: integer
        proxy:
          type: object
          properties:
            enabled:
              type: boolean
            url:
              type: string
              format: uri
            auth:
              type: object
              properties:
                username:
                  type: string
                password:
                  type: string
                  format: password
        cache:
          type: object
          properties:
            enabled:
              type: boolean
            ttl:
              type: integer
              description: Cache TTL (seconds)
            maxSize:
              type: integer
              description: Max cache size (MB)

    ProviderSettings:
      type: object
      properties:
        provider:
          type: string
        apiKey:
          type: string
          format: password
        endpoint:
          type: string
          format: uri
        model:
          type: string
        timeout:
          type: integer
          description: Timeout (milliseconds)
        maxRetries:
          type: integer
        temperature:
          type: number
        maxTokens:
          type: integer
        streamResponse:
          type: boolean
        customHeaders:
          type: object
          additionalProperties:
            type: string

    PrivacySettings:
      type: object
      properties:
        collectAnalytics:
          type: boolean
          default: false
        shareUsageData:
          type: boolean
          default: false
        storageLocation:
          type: string
          enum:
            - local
            - cloud
            - hybrid
          default: local
        dataRetention:
          type: object
          properties:
            enabled:
              type: boolean
            days:
              type: integer
        encryption:
          type: object
          properties:
            enabled:
              type: boolean
            algorithm:
              type: string
        autoDeleteHistory:
          type: boolean
        historyRetentionDays:
          type: integer

    NotificationSettings:
      type: object
      properties:
        enabled:
          type: boolean
          default: true
        sound:
          type: boolean
          default: true
        desktop:
          type: boolean
          default: true
        email:
          type: boolean
        types:
          type: object
          properties:
            taskComplete:
              type: boolean
            errors:
              type: boolean
            updates:
              type: boolean
            reminders:
              type: boolean
        quietHours:
          type: object
          properties:
            enabled:
              type: boolean
            start:
              type: string
              description: Start time (HH:mm format)
            end:
              type: string
              description: End time (HH:mm format)

    ShortcutSettings:
      type: object
      properties:
        enabled:
          type: boolean
          default: true
        customShortcuts:
          type: object
          additionalProperties:
            type: string
        conflictResolution:
          type: string
          enum:
            - override
            - ignore
            - prompt
          default: prompt

    AudioSettings:
      type: object
      properties:
        inputDevice:
          type: string
        outputDevice:
          type: string
        inputVolume:
          type: integer
          minimum: 0
          maximum: 100
          default: 70
        outputVolume:
          type: integer
          minimum: 0
          maximum: 100
          default: 70
        noiseCancellation:
          type: boolean
          default: true
        echoCancellation:
          type: boolean
          default: true
        autoGainControl:
          type: boolean
          default: true
        sampleRate:
          type: integer
        bitRate:
          type: integer

    VideoSettings:
      type: object
      properties:
        camera:
          type: string
        resolution:
          type: string
        frameRate:
          type: integer
        quality:
          type: string
          enum:
            - low
            - medium
            - high
            - auto
          default: auto
        hardwareAcceleration:
          type: boolean
          default: true

    PerformanceSettings:
      type: object
      properties:
        enableGPU:
          type: boolean
          default: true
        maxConcurrentRequests:
          type: integer
          default: 3
        memoryLimit:
          type: integer
          description: Memory limit (MB)
        cpuLimit:
          type: integer
          description: CPU limit (percentage)
        autoOptimize:
          type: boolean
          default: true
        lowPowerMode:
          type: boolean
        backgroundProcessing:
          type: boolean
          default: true

    ExperimentalSettings:
      type: object
      properties:
        enabled:
          type: boolean
        features:
          type: object
          properties:
            betaFeatures:
              type: boolean
            alphaFeatures:
              type: boolean
            debugMode:
              type: boolean
            developerConsole:
              type: boolean
        flags:
          type: object
          additionalProperties:
            type: boolean

    UserSettings:
      type: object
      properties:
        userId:
          type: string
        displayName:
          type: string
        email:
          type: string
          format: email
        avatar:
          type: string
          format: uri
        preferences:
          type: object
          properties:
            defaultFeature:
              type: string
            favoriteFeatures:
              type: array
              items:
                type: string
            recentFeatures:
              type: array
              items:
                type: string

    GetSettingsResponse:
      type: object
      properties:
        app:
          $ref: '#/components/schemas/AppSettings'
        user:
          $ref: '#/components/schemas/UserSettings'
        lastSynced:
          type: string
          format: date-time
        needsUpdate:
          type: boolean

    UpdateSettingsRequest:
      type: object
      properties:
        app:
          $ref: '#/components/schemas/AppSettings'
        user:
          $ref: '#/components/schemas/UserSettings'
        merge:
          type: boolean
          default: true
          description: Merge with existing settings

    ResetSettingsRequest:
      type: object
      required:
        - scope
      properties:
        scope:
          oneOf:
            - type: string
              enum:
                - all
                - app
                - user
            - type: array
              items:
                type: string
        keepUserData:
          type: boolean
          default: false

    ExportSettingsRequest:
      type: object
      required:
        - format
      properties:
        format:
          type: string
          enum:
            - json
            - yaml
            - ini
        includeSecrets:
          type: boolean
          default: false
        prettify:
          type: boolean
          default: true

    ValidateSettingsResponse:
      type: object
      properties:
        valid:
          type: boolean
        errors:
          type: array
          items:
            type: object
            properties:
              path:
                type: string
              message:
                type: string
              value:
                type: object
        warnings:
          type: array
          items:
            type: object
            properties:
              path:
                type: string
              message:
                type: string

    SyncStatus:
      type: object
      properties:
        enabled:
          type: boolean
        lastSync:
          type: string
          format: date-time
        nextSync:
          type: string
          format: date-time
        status:
          type: string
          enum:
            - idle
            - syncing
            - error
            - offline
        conflicts:
          type: array
          items:
            type: object
            properties:
              key:
                type: string
              local:
                type: object
              remote:
                type: object

    Metadata:
      type: object
      properties:
        requestId:
          type: string
          format: uuid
        timestamp:
          type: string
          format: date-time
        version:
          type: string

    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
        details:
          type: object

  responses:
    BadRequest:
      description: Invalid request parameters
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              error:
                $ref: '#/components/schemas/Error'
